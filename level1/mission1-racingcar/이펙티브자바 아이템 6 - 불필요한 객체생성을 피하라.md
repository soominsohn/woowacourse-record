# 이펙티브자바 아이템 6 - 불필요한 객체생성을 피하라

[https://a1010100z.tistory.com/167](https://a1010100z.tistory.com/167)

1. 같은 값임에도 다른 레퍼런스인 경우
    
    같은 값을 가지고 동시에 불변객체라면 같은 레퍼런스를 가져야한다.
    
    다시말해, 같은 값을 가지는 인스턴스가 두 개 이상 만들어 지는 것은 "불필요한 객체생성"이다.
    
    대표적인 불편클래스 String 을 예로들면,
    
    String 클래스는 같은 문자열이라면 같은 레퍼런스를 지닌다.
    

1. 재사용 빈도가 높고 생성비용이 비싼 경우 캐싱 방식을 고려해야 한다.
    
    자바의 Pattern 객체는 생성비용이 높은 클래스 중 하나이다.
    
    보통 정규표현식을 사용할 때 String.matches()안의 인자로 Pattern 객체를 사용하는데, 이 Pattern 객체는 생성비용이 높은 클래스 중 하나이다.
    
    Pattern은 입력받은 정규표현식에 해당하는 유한 상태 머신(finite state machine)을 만들기 때문에 인스턴스 생성 비용이 높다.
    
    유한상태머신이란?
    
    automaton, FA; 복수형: 
    
    유한 오토마타 (finite automata)는 컴퓨터 프로그램과 전자 논리 회로를 설계하는데에 쓰이는 수학적 모델이다. 간단히 상태 기계라고 부르기도 한다. 유한 상태 기계는 유한한 개수의 상태를 가질 수 있는 오토마타, 즉 추상 기계라고 할 수 있다. 이러한 기계는 한 번에 오로지 하나의 상태만을 가지게 되며, ***현재 상태***(Current State)란 임의의 주어진 시간의 상태를 칭한다. 이러한 기계는 ***어떠한 사건***(Event)에 의해 한 상태에서 다른 상태로 변화할 수 있으며, 이를 ***전이***(Transition)이라 한다. 특정한 유한 오토마톤은 현재 상태로부터 가능한 전이 상태와, 이러한 전이를 유발하는 조건들의 집합으로서 정의된다.
    
    정규표현식을 표현하는 Pattern 인스턴스를 static final로 캐싱해두고 재사용하여 성능을 개선하자!
    

1. 같은 인스턴스를 대변하는 여러개의 인스턴스를 생성하지 않는다.
    
    ex) Map 인터페이스의 keySet 함수
    
    keySet 메서드는 Set 인스턴스를 반환한다. 하지만 동일한 Map 에서 호출하는 keySet 메서드는 같은 Map 을 대변하기 때문에 거기서 생성되는 Set 인스턴스들은 결국 동일한 Map 을 대변할 뿐이다.
    
2. 오토박싱
    
    불필요한 박싱/언박싱(예: int → Integer, Interger → int) 은  불필요한 메모리 할당, 재할당을 반복한다.
    
    꼭 박싱 타입이 필요한 경우가 아니라면 기본타입을 사용하자.