# ìŠ¤í”„ë§ì˜ ìš”ì²­ê³¼ ì‘ë‹µ

ìŠ¤í”„ë§ì˜ ìš”ì²­ê³¼ ì‘ë‹µ (requestì™€ response)

í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì˜ í†µì‹  ğŸ™‚

![Untitled](%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%E1%84%8B%E1%85%B4%20%E1%84%8B%E1%85%AD%E1%84%8E%E1%85%A5%E1%86%BC%E1%84%80%E1%85%AA%20%E1%84%8B%E1%85%B3%E1%86%BC%E1%84%83%E1%85%A1%E1%86%B8%20d040211e0f944c70b86c09407acb3734/Untitled.png)

í´ë¼ì´ì–¸íŠ¸ê°€ ì •ë³´ë¥¼ ìš”ì²­í•˜ë©´ ì„œë²„ëŠ” ì •ë³´ë¥¼ ì¤€ë‹¤.

í´ë¼ì´ì–¸íŠ¸ì˜ Request: ì•ˆë…• ì„œë²„ :) ë‚´ **ì´ë¦„ì€ ì•¤ì§€**ì´ê³ , **íšŒì›ë²ˆí˜¸ëŠ” 12**ì•¼. ë‚œ ë‚´ **íšŒì› ë“±ê¸‰**ì´ ê¶ê¸ˆí•´! ì•Œë ¤ì¤„ ìˆ˜ ìˆê² ë‹ˆ?

ì„œë²„ì˜ Response: ì•ˆë…• í´ë¼ì´ì–¸íŠ¸! ë„ˆì˜ **ì´ë¦„ì´ ì•¤ì§€**ì´ê³  **íšŒì›ë²ˆí˜¸ê°€ 12**ì¸ê±¸ í™•ì¸í–ˆì–´! ë„ˆì˜ **íšŒì› ë“±ê¸‰ì€ ë‹¤ì´ì•„ì•¼**. ^0^

ê³¼ì—° ì´ Requestì™€ Response, ğŸŒ±Â Spring ğŸŒ±Â  ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œëŠ” ì–´ë–»ê²Œ ì£¼ê³  ë°›ì„ê¹Œìš”~?

ë°”ë¡œë°”ë¡œë°”ë¡œ

í´ë¼ì´ì–¸íŠ¸ì˜ Request

- HTTP method ë¥¼ í†µí•œ GET, POST, PUT, PATCH, DELETE ìš”ì²­
- URI ì¿¼ë¦¬ ìŠ¤íŠ¸ë§
- body

ì„œë²„ì˜ Response

- html, hbs, jsp ì™€ ê°™ì€ View ğŸ™‚
- restAPI ë°©ì‹ì˜ json ë°ì´í„°

Request ë¨¼ì € ë³¼ê¹Œìš©~?

1. URI ì¿¼ë¦¬íŒŒë¼ë¯¸í„°ë¡œ ìš”ì²­ë°›ê¸° (ë³´í†µ GET method)

@RequestParam, @PathVariable

**@RequestParam**

í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ URIë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ê°€ì •í•´ë³´ì.

Get [http://localhost:8080/hey/user?name=ì•¤ì§€](http://localhost:8080/hey/user?name=%EC%95%A4%EC%A7%80). ìœ„ ìš”ì²­ì—ì„  nameì— ëŒ€í•œ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì•¼ í•œë‹¤.

```java
@RestController
@RequestMapping("/hey")
public class UserController {

    @GetMapping("/user")
    public String joinAccountWithRequestParam(@RequestParam String name) {
        return name;
    }
}
```

URI parameterì˜ ì´ë¦„ê³¼ @RequestParam ë’¤ì˜ ì´ë¦„ì´ ê°™ì´ì•„ í•œë‹¤! 

![Untitled](%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%E1%84%8B%E1%85%B4%20%E1%84%8B%E1%85%AD%E1%84%8E%E1%85%A5%E1%86%BC%E1%84%80%E1%85%AA%20%E1%84%8B%E1%85%B3%E1%86%BC%E1%84%83%E1%85%A1%E1%86%B8%20d040211e0f944c70b86c09407acb3734/Untitled%201.png)

ë‹¤ë¥´ë©´ 400ë²ˆ ì—ëŸ¬ë¥¼ ë˜ì§„ë‹¤.

name(value) ì˜µì…˜ì„ ë„£ì–´ì£¼ë©´ ë‹¬ë¼ë„ ì˜ë¨

```java
@RestController
@RequestMapping("/hey")
public class UserController {

    @GetMapping("/user")
    public String joinAccountWithRequestParam(@RequestParam(name = "name") String fakeName) {
        return fakeName;
    }
}
```

ì˜µì…˜ìœ¼ë¡œ required ì„¤ì •ë„ ê°€ëŠ¥, defaultValueë„ ì„¤ì • ê°€ëŠ¥.

```java
@RestController
@RequestMapping("/hey")
public class UserController {

    @GetMapping("/user")
    public String joinAccountWithRequestParam(@RequestParam(required = false, defaultValue = "ì•¤ì§€") String name) {
        return name;
    }
}
```

@PathVariable

[http://localhost:8080/hey/user](http://localhost:8080/hey/user?name=%EC%95%A4%EC%A7%80)/1

Get ìš”ì²­ or,, Post ìš”ì²­ ì‹œ, ë³€ê²½í•˜ëŠ” uri ê°’ì„ ë§¤í•‘í•  ìˆ˜ ìˆìŒ !!

ê°œì¸ì ìœ¼ë¡œ restfulí•œ uri ì„¤ê³„ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ”  ìš°ì•„í•œ ì¹œêµ¬ë¼ê³  ìƒê°í•¨.

```java
@RestController
@RequestMapping("/hey")
public class UserController {

    @GetMapping("/user/{id}")
    public String joinAccountWithPathVariable(@PathVariable String id) {
        return id;
    }

}
```

uri ìƒì˜ ì´ë¦„ê³¼, pathVariable ì˜†ì˜ íŒŒë¼ë¯¸í„° ì´ë¦„ì´ ì¼ì¹˜í•´ì•¼í•¨. ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´?

![Untitled](%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%E1%84%8B%E1%85%B4%20%E1%84%8B%E1%85%AD%E1%84%8E%E1%85%A5%E1%86%BC%E1%84%80%E1%85%AA%20%E1%84%8B%E1%85%B3%E1%86%BC%E1%84%83%E1%85%A1%E1%86%B8%20d040211e0f944c70b86c09407acb3734/Untitled%202.png)

500ë²ˆ white label error page ëœ¸!!

1. bodyë¡œ ìš”ì²­ë°›ê¸° (ë³´í†µ POST method)

@ModelAttribute (get ìš”ì²­ ì‹œ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ or http form data~~)

html form í˜•ì‹ìœ¼ë¡œ ë„˜ì–´ì˜¬ ë•Œ application/multipart/form-dataë¡œ ë„˜ì–´ì˜¤ëŠ” ê²½ìš°ê°€ ë§ì€ë°, ì–œ RequestBodyì¸ì‹ì„ ëª»í•´ì„œ ì´ê±¸ë¡œ ë°›ìœ¼ë©´ ì¢‹ìŒ.

- post ìš”ì²­

```java
//use ModelAttribute
    @PostMapping("/user3")
    public ResponseEntity<User2> joinAccountWithModelAttribute1(@ModelAttribute User2 user) {
        return ResponseEntity.ok(user);
    }
```

```java
public class User3 {

    private String name;
    private String email;

    public User3() {
    }

    public User3(String name, String email) {
        this.name = name;
        this.email = email;
    }

    public String getName() {
        return name;
    }

    public String getEmail() {
        return email;
    }

//    public void setName(String name) {
//        this.name = name;
//    }
//
//    public void setEmail(String email) {
//        this.email = email;
//    }

    @Override
    public String toString() {
        return "User3{" +
                "name='" + name + '\'' +
                ", email='" + email + '\'' +
                '}';
    }
}
```

 @ModelAttributeëŠ” ìƒëµì´ ê°€ëŠ¥í•˜ë‹¤.

- ê¸°ë³¸ ìƒì„±ì + setter X : í•„ë“œì— null ê°’ ë“¤ì–´ê°
- ê¸°ë³¸ ìƒì„±ì + setter O: ìƒì„± O
- í•„ë“œ ë‹¤ìˆëŠ” ìƒì„±ì: ìƒì„± O
- ê¸°ë³¸ìƒì„±ì + í•„ë“œ ë‹¤ ìˆëŠ” ìƒì„±ì: í•„ë“œì— null ê°’ ë“¤ì–´ê°
- ê¸°ë³¸ìƒì„±ì + í•„ë“œ ë‹¤ ìˆëŠ” ìƒì„±ì + setter: ìƒì„± O

@RequestBody

ì–˜ë¥¼ ì“°ë©´, ìš”ì²­ json í˜•ì‹ì„ String ê·¸ëŒ€ë¡œ ë°›ì•„ì˜¤ê¸° ë•Œë¬¸ì—, ì •ë³´ë¥¼ ë³€í™˜í•´ì£¼ëŠ” ë¬´ì—‡ì¸ê°€ê°€ í•„ìš”,,

```java
@PostMapping("/user")
    public String joinAccountWithRequestBody(@RequestBody String name) {
        System.out.println(name);
        return name;
    }
```

![Untitled](%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%E1%84%8B%E1%85%B4%20%E1%84%8B%E1%85%AD%E1%84%8E%E1%85%A5%E1%86%BC%E1%84%80%E1%85%AA%20%E1%84%8B%E1%85%B3%E1%86%BC%E1%84%83%E1%85%A1%E1%86%B8%20d040211e0f944c70b86c09407acb3734/Untitled%203.png)

![Untitled](%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%E1%84%8B%E1%85%B4%20%E1%84%8B%E1%85%AD%E1%84%8E%E1%85%A5%E1%86%BC%E1%84%80%E1%85%AA%20%E1%84%8B%E1%85%B3%E1%86%BC%E1%84%83%E1%85%A1%E1%86%B8%20d040211e0f944c70b86c09407acb3734/Untitled%204.png)

HTTP ìš”ì²­ ë³¸ë¬¸(JSON ë° XML ë“±)ì„ Java ì˜¤ë¸Œì íŠ¸ë¡œÂ **ë³€í™˜**

```java
@PostMapping(path = "/user2")
public ResponseEntity<User3> joinAccountWithRequestBody2(@RequestBody User3 user) {
    System.out.println(user);
    return null;
}
```

```java
public class User3 {

    private String name;
    private String email;

    public User3() {
    }

//    public User3(String name, String email) {
//        this.name = name;
//        this.email = email;
//    }

    public String getName() {
        return name;
    }

    public String getEmail() {
        return email;
    }

    @Override
    public String toString() {
        return "User3{" +
                "name='" + name + '\'' +
                ", email='" + email + '\'' +
                '}';
    }
}
```

ê°ì²´ì—

- ê¸°ë³¸ìƒì„±ì + ê²Œí„° : ìƒì„± OK
- ê¸°ë³¸ìƒì„±ì + ê²Œí„°(x): ìƒì„± OK, but í•„ë“œì— nullê°’
- í•„ë“œ ë‹¤ìˆëŠ” ìƒì„±ì: ìƒì„± OK!

ë” ì•Œì•„ë³´ê¸°: response bodyì˜ ì§ë ¬í™”ì™€ ì—­ì§ì—´í™”

[https://tecoble.techcourse.co.kr/post/2021-05-11-requestbody-modelattribute/](https://tecoble.techcourse.co.kr/post/2021-05-11-requestbody-modelattribute/)

Response ë³¼ê¹Œìš©~?

1. ì •ì  view ì‘ë‹µ

- return type Stringì¸ ê²½ìš° ğŸ™‚Â  â†’ í•´ë‹¹ view íŒŒì¼ ëœë”ë§í•´ì„œ ë°˜í™˜

```java
@Controller
public class TestController {

    @GetMapping("/")
    public String getIndex() {
        return "index";
    }
}
```

```java
@Controller
public class TestController {
    @GetMapping("/")
    public String getIndex(Model model) {
        model.addAttribute("message", "ì•ˆë…•í•˜ì„¸ìš”");
        return "index";
    }
}
```

ëª¨ë¸ì— ë„£ì–´ì„œë„ ë°˜í™˜ ê°€ëŠ¥

- view
- ModelAndView

```java
@GetMapping("/{gameId}")
    public ModelAndView getGameByGameId(@PathVariable long gameId,
        @RequestParam(required = false, defaultValue = MOVE_SUCCESS_MESSAGE) String gameMessage) {
        
        ModelAndView modelAndView = new ModelAndView("game");

        modelAndView.addObject("pieces",
            BoardView.of(chessGameService.findCurrentPieces(gameId)).getBoardView());
        modelAndView.addObject("gameId", gameId);
        modelAndView.addObject("status", chessGameService.calculateGameResult(gameId));
        modelAndView.addObject("gameMessage", gameMessage);

        return modelAndView;
    }
```

1. json ì‘ë‹µ
- ResponseBody
- ResponseEntity

![Untitled](%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%E1%84%8B%E1%85%B4%20%E1%84%8B%E1%85%AD%E1%84%8E%E1%85%A5%E1%86%BC%E1%84%80%E1%85%AA%20%E1%84%8B%E1%85%B3%E1%86%BC%E1%84%83%E1%85%A1%E1%86%B8%20d040211e0f944c70b86c09407acb3734/Untitled%205.png)

- ResponseBody

Annotationìœ¼ë¡œ ì‚¬ìš© ğŸ˜Š

*HTTP*ìš”ì²­ì„ ê°ì²´ë¡œ ë³€í™˜í•˜ê±°ë‚˜, ê°ì²´ë¥¼ ì‘ë‹µìœ¼ë¡œ ë³€í™˜í•˜ëŠ”Â *HttpMessageConverter*ë¥¼ ì‚¬ìš©

*response body*ì— ì§ë ¬í™”

@Controller + @ResponseBody == @RestController

```java
@ResponseBody
@ResponseStatus(HttpStatus.OK)
public MoveResponseDto move(@PathVariable String name, @RequestBody MoveDto moveDto) {
  String command = makeMoveCmd(moveDto.getSource(), moveDto.getTarget());
    springChessService.move(name, command, new Commands(command));
    
  MoveResponseDto moveResponseDto = new MoveResponseDto(springChessService
      .continuedGameInfo(name), name);
      
  return moveResponseDto;
}
```

ë‹¨ì 

1. http header ì„¤ì • ë¶ˆê°€ëŠ¥
2. http statusë¥¼ ì–´ë…¸í…Œì´ì…˜ ì˜†ì—ì„œ ì„¤ì •í•´ ì¤˜ì•¼í•¨ ã… ^ã… 

- ResponseEntity

```java
//HttpEntity ì„ ì–¸ êµ¬ì¡°
public class HttpEntity<T> {
    public static final HttpEntity<?> EMPTY = new HttpEntity<>();
  
  
    private final HttpHeaders headers;
  
    @Nullable
    private final T body;
}
```

*ResponseBody*ì™€ ë‹¤ë¥´ê²Œ ê°ì²´ ì•ˆì—ì„œÂ *Header*ë¥¼ ì„¤ì •í•´ ì¤„ ìˆ˜ ìˆë‹¤. 

```java
public ResponseEntity<MoveResponseDto> move(@PathVariable String name,
    @RequestBody MoveDto moveDto) {
    HttpHeaders headers = new HttpHeaders();
    headers.set("Game", "Chess");
    
    String command = makeMoveCmd(moveDto.getSource(), moveDto.getTarget());
    springChessService.move(name, command, new Commands(command));
    
    MoveResponseDto moveResponseDto = new MoveResponseDto(springChessService
        .continuedGameInfo(name), name);

    return new ResponseEntity<MoveResponseDto>(moveResponseDto, headers, HttpStatus.valueOf(200)); // ResponseEntityë¥¼ í™œìš©í•œ ì‘ë‹µ ìƒì„±
}
```

```java
return new ResponseEntity<MoveResponseDto>(moveResponseDto, headers, HttpStatus.valueOf(200));

  return ResponseEntity.ok()
        .headers(headers)
        .body(moveResponseDto);
```

ì´ë ‡ê²Œ ì‰½ê³  ê°„ë‹¨í•˜ê²Œ~~

ë” ì•Œì•„ë³¼ ê²ƒ

- *HttpMessageConverter ê¹Œë³´ê¸°*
- HttpEntity
- builder íŒ¨í„´